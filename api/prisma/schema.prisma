generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum TipoUsuario {
  PLAYER
  DONO_TIME
  DONO_SOCIETY
}

enum TipoPagamento {
  AVULSO
  MENSALISTA
  CONSUMO_BAR
}

enum TipoCampeonato {
  MATA_MATA
  GRUPOS
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// USUÃRIO
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Usuario {
  id           Int       @id @default(autoincrement())
  nome         String
  cpf          String?   @unique
  email        String    @unique
  senha        String // necessÃ¡rio para login
  telefone     String?
  pernaMelhor  String?
  posicaoCampo String?
  altura       Float?
  peso         Float?
  modalidade   String?
  nascimento   DateTime?
  goleiro      Boolean?
  sexo         String?

  // Dono de um time (1:1)
  timeDono Time? @relation("TimeDono")

  // Jogador vinculado a um time (N:1)
  timeRelacionadoId Int?
  timeRelacionado   Time? @relation("TimeJogadores", fields: [timeRelacionadoId], references: [id])

  tipo TipoUsuario @default(PLAYER)

  // 1 usuÃ¡rio â†’ vÃ¡rios societies
  societies Society[] @relation("UsuarioSocieties")

  pagamentos     Pagamento[]
  notificacoes   Notificacao[]
  societyPlayers SocietyPlayer[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SOCIETY
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Society {
  id        Int     @id @default(autoincrement())
  usuarioId Int
  dono      Usuario @relation("UsuarioSocieties", fields: [usuarioId], references: [id])

  imagem    String?
  nome      String
  descricao String?
  telefone  String?
  whatsapp  String?
  email     String?
  website   String?
  instagram String?
  facebook  String?
  youtube   String?

  cep      String?
  endereco String?
  estado   String?
  cidade   String?

  cardapio       Cardapio[]
  campos         Campo[]
  societyPlayers SocietyPlayer[]
  pagamentos     Pagamento[]

  // ğŸ”¥ campeonatos desse society
  campeonatos Campeonato[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CARDÃPIO
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Cardapio {
  id        Int     @id @default(autoincrement())
  societyId Int
  society   Society @relation(fields: [societyId], references: [id])

  nome  String
  preco Float

  createdAt DateTime @default(now())
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CAMPOS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Campo {
  id        Int     @id @default(autoincrement())
  societyId Int
  society   Society @relation(fields: [societyId], references: [id])

  nome          String
  valorAvulso   Float?
  valorMensal   Float?
  foto          String?
  dimensoes     String?
  estiloGramado String?

  createdAt DateTime @default(now())
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TIME
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Time {
  id         Int     @id @default(autoincrement())
  nome       String
  brasao     String?
  descricao  String?
  estado     String?
  cidade     String?
  modalidade String?

  // Dono do time (1:1)
  donoId Int?     @unique
  dono   Usuario? @relation("TimeDono", fields: [donoId], references: [id])

  // Jogadores desse time
  jogadores Usuario[] @relation("TimeJogadores")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // times inscritos em campeonatos (tabela de junÃ§Ã£o)
  timeCampeonatos TimeCampeonato[]

  // jogos em que esse time Ã© mandante
  jogosMandante Jogo[] @relation("JogoTimeA")

  // jogos em que esse time Ã© visitante
  jogosVisitante Jogo[] @relation("JogoTimeB")

  // campeonatos que esse time venceu
  campeonatosVencidos Campeonato[] @relation("CampeaoTime")
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PAGAMENTOS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Pagamento {
  id        Int     @id @default(autoincrement())
  usuarioId Int
  usuario   Usuario @relation(fields: [usuarioId], references: [id])

  societyId Int
  society   Society @relation(fields: [societyId], references: [id])

  tipo      TipoPagamento
  valor     Float
  descricao String?

  createdAt DateTime @default(now())
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RELAÃ‡ÃƒO N:N â€“ SOCIETY x USUÃRIOS (JOGADORES)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model SocietyPlayer {
  id Int @id @default(autoincrement())

  societyId Int
  society   Society @relation(fields: [societyId], references: [id])

  usuarioId Int
  usuario   Usuario @relation(fields: [usuarioId], references: [id])

  createdAt DateTime @default(now())
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// NOTIFICAÃ‡Ã•ES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Notificacao {
  id        Int     @id @default(autoincrement())
  usuarioId Int
  usuario   Usuario @relation(fields: [usuarioId], references: [id])

  titulo   String
  mensagem String
  lido     Boolean @default(false)

  createdAt DateTime @default(now())
}

//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CAMPEONATO / TIMES / JOGOS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//

model Campeonato {
  id        Int     @id @default(autoincrement())
  societyId Int
  society   Society @relation(fields: [societyId], references: [id])

  nome     String
  tipo     TipoCampeonato
  maxTimes Int

  // time campeÃ£o (opcional) â€“ relaÃ§Ã£o nomeada
  campeaoId Int?
  campeao   Time? @relation("CampeaoTime", fields: [campeaoId], references: [id])

  times TimeCampeonato[]
  jogos Jogo[]

  createdAt DateTime @default(now())
}

model TimeCampeonato {
  id           Int        @id @default(autoincrement())
  campeonatoId Int
  campeonato   Campeonato @relation(fields: [campeonatoId], references: [id])

  timeId Int
  time   Time @relation(fields: [timeId], references: [id])
}

model Jogo {
  id           Int        @id @default(autoincrement())
  campeonatoId Int
  campeonato   Campeonato @relation(fields: [campeonatoId], references: [id])

  round   Int // 1 = oitavas, 2 = quartas, 3 = semi, 4 = final...
  timeAId Int
  timeA   Time @relation("JogoTimeA", fields: [timeAId], references: [id])

  timeBId Int
  timeB   Time @relation("JogoTimeB", fields: [timeBId], references: [id])

  golsA      Int?
  golsB      Int?
  vencedorId Int? // apenas o id, sem relaÃ§Ã£o obrigatÃ³ria
}
